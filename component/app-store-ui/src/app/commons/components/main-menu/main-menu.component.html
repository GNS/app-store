<mat-nav-list>

  <ng-container *ngFor="let menu of mainMenu">
    <mat-list-item [routerLink]="menu.route" *ngIf="!menu.subMenu else innerMenu"
     [ngClass]="{'selected':menu.id === selectedMenu?.id}">
      <mat-icon>{{menu.icon}}</mat-icon>
      <span>{{menu.name}}</span>
    </mat-list-item>
    <ng-template #innerMenu>

      <mat-accordion>

        <mat-expansion-panel expanded="true">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <mat-icon>{{menu.icon}}</mat-icon>
              {{menu.name}}
            </mat-panel-title>
          </mat-expansion-panel-header>

          <mat-nav-list>
            <mat-list-item [routerLink]="sub.route" *ngFor="let sub of menu.subMenu" 
            [ngClass]="{'selected':sub.id === selectedMenu?.id}">
              <mat-icon>{{sub.icon}}</mat-icon>
              <span>{{sub.name}}</span>
            </mat-list-item>
          </mat-nav-list>

        </mat-expansion-panel>

      </mat-accordion>

    </ng-template>

  </ng-container>

</mat-nav-list>